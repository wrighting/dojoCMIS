<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
   <title>CmisStore example page</title>
   <script type="text/javascript">
            var appContext = "/share";
         
            var dojoConfig = {
               tlmSiblingOfDojo: false,
               async: true,
               parseOnLoad: false,
               packages: [
                  { name: "dojo", location: location.pathname.replace(/\/[^/]+$/, '') + '/js/lib/dojo-1.10.4/dojo'},
                  { name: "dijit", location: location.pathname.replace(/\/[^/]+$/, '') + '/js/lib/dojo-1.10.4/dijit'},
                  { name: "dgrid", location: location.pathname.replace(/\/[^/]+$/, '') + '/target/classes/META-INF/resources/webjars/dgrid/0.3.17'},
                  { name: "put-selector", location: location.pathname.replace(/\/[^/]+$/, '') + '/target/classes/META-INF/resources/webjars/put-selector/0.3.5'},
                  { name: "xstyle", location: location.pathname.replace(/\/[^/]+$/, '') + '/src/main/resources/xstyle'},
                  { name: "cggh", location: location.pathname.replace(/\/[^/]+$/, '') + '/src/main/resources/cggh'}

               ]
            };
         </script>
         <script type="text/javascript" src="node_modules/dojo/dojo.js"></script>
<style media="screen" type="text/css">
@import url("js/lib/dojo-1.10.4/dijit/themes/claro/claro.css");
</style>
	<style>
		.errorMessage {
			height: 1em;
			margin: 1em 2em;
			padding: 1em 2em;

			background-color: #fcc;
			color: #900;
		}
		.hidden {
			display: none;
		}
	</style>
<script> 


	require(
			[ "dojo/dom", "cggh/cmis/CmisGrid", "dojo/domReady!" ],
			function(dom, CmisGrid) {

				var	targetRoot = "http://alfresco5.cggh.org:8080/alfresco/api/-default-/public/cmis/versions/1.1/browser";
				var	testFolder = '/Sites/aaa-upgrade-test-site/documentLibrary/Test';

				this.grid = new CmisGrid(
						{
							targetRoot : targetRoot,
							query : {
								/*
								 'statement' : 'SELECT * FROM cgghPub:publicationFolder ' +
								 'join cgghPub:publication as p on cmis:objectId = p.cmis:objectId ' + 
								 'join cm:titled as t on cmis:objectId = t.cmis:objectId',
								 */
								path : testFolder
							},
							columns : [ {
								field : "cmis:name",
								formatter : this.formatLinkFunction
							}, {
								parentType : "cggh:collaboration",
								field : "cggh:ragStatus"
							}, {
								parentType : "cggh:collaboration",
								field : "cggh:webTitleApproved"
							}, {
								parentType : "cggh:collaboration",
								field : "cmis:lastModificationDate"
							}, {
								parentType : "cggh:collaboration",
								field : "cggh:species"
							}, {
								field : "cmis:createdBy"
							}, {
								parentType : "cggh:collaboration",
								field : "cmis:creationDate"
							} ]
						});
				var messageNode = dom.byId('message');
				this.grid.on('dgrid-error', function(event) {
				    // Display an error message above the grid when an error occurs.
				    messageNode.className = 'errorMessage';
				    messageNode.innerHTML = event.error.message;
				});
				this.grid.placeAt("grid-place");
				this.grid.startup();
			});
</script>
</head>

<body id="Share" class="yui-skin-lightTheme claro alfresco-share">
<div id="message" class="message hidden"></div>
<div id="grid-place"></div></td>
</body>
</html>
